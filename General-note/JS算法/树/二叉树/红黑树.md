---
title: 红黑树
---
红黑树是数据结构中难点中的难点
[红黑树（图解+秒懂+史上最全） - 疯狂创客圈 - 博客园](https://www.cnblogs.com/crazymakercircle/p/16320430.html)

特性：
1.节点是红色或黑色
2.根节点是黑色
3.每个叶子节点都是黑色的空节点（NIL节点）
4.每个红色节点的子节点都是黑色（从每个叶子到根的所有路径上不能有两个连续的红色节点）
5.任一节点到其每个叶子的所有路径都包含相同数目的黑色节点


![img](https://img-blog.csdnimg.cn/20200901114718174.png)


约束保证了红黑树的关键特性：
从根节点到叶节点最长可能路径不会超过最短路径的2倍
基本是平衡的。

为什么可以做到：

性质4决定了路径上不能有2个相连的红色节点
最短可能路径都是黑色节点
最长可能路径是红色和黑色交替
性质5所有路径都有相同的黑色节点

## 插入节点

插入一个新节点，可能树不平衡，可以通过三种方式让树平衡

换色、左旋转、右旋转

插入的新节点通常都是==红色节点==

因为插入节点是红色的时候有可能插入一次不违反任何规则

而插入黑色节点，==必然导致有一条路径上多了黑色节点==

红色节点可能导致红红相连，但可以通过颜色调换和旋转调整

## 旋转

左旋转 - 逆时针旋转节点，让用当前节点的右子节点替换，当前节点成为左子节点。
右旋转相反

![img](https://img-blog.csdnimg.cn/img_convert/dea622e0576539552458e3afcffb1f59.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/82f3502b5be24051bd7688b1e0f36135.png)

## 插入操作
要插入的节点为N，父节点为P
祖父节点为G，父节点的兄弟节点为U
		（G）
		/       \
	   (P)          (U)
	   /
	 (N)

插入一共有5种情况：
1.插入的是根节点
直接插入，然后变色为黑节点

2.插入的节点的父节点P是黑色的
直接插入，节点添加两个黑色NIL节点

3.父节点P和叔节点U都是红色
将P和U变为黑色，将G变为红色
可能的问题：G的父节点也为红色，可以递归调整颜色。（也就是可以把G及以下的子节点都看成一个大的红色节点要插入进去，需要继续调整其父节点的颜色）
如果调整颜色到了根节点，根节点依然是黑色

4.N的U是黑色节点，且N是左孩子
P红 G黑 U黑 N左
		（G）
		/       \
	  ==(P)==          (U)
	  /   \
	==(N)==  (B)

转换：父黑、祖红、右旋转、兄弟B平移
	    (P)
	   /         \
	==(N)==         ==(G)==
		   /       \
		(B)       (U)

5.N的U是黑色节点，且N是右孩子
P红 G黑 U黑 N右
		（G）
		/       \
	  ==(P)==          (U)
	  /   \
	(B)   ==(N)==

第一步以P为根进行左旋
		（G）
		/       \
	  ==(N)==          (U)
	  /   
	==(P)==
	/
   (B)

将P作为新插入的情况即可（也就是变为了情况4

N黑 G红 右旋
		（N）
		/       \
	  ==(P)==          ==(G)==
	  /                 \
	(B)                 (U)
