---
title: 执行顺序
---
```js
console.log("start"); // 1.同步代码

setTimeout(() => {
  console.log("setTimeout1"); // 宏任务1
}, 0);

(async function foo() {
  console.log("async 1"); // 2.IIFE里的同步代码

  await asyncFunction(); // 2.5跳转

  console.log("async2"); //上一个await结束以后到这里

})().then(console.log("foo.then")); // 5.这里的then传入的是函数的调用，相当于function onFulfilled()，这个函数返回值为undefined，相当于then传入的onFulfilled为undefined，所以这里then的console.log直接调用了，是同步函数

async function asyncFunction() {
  console.log("asyncFunction"); // 3.异步函数里的同步代码

  setTimeout(() => {
    console.log("setTimeout2"); // 宏任务2
  }, 0);

  new Promise((res) => {
    console.log("promise1"); // 4.构造promise里的同步代码

    res("promise2"); // 微任务1
  }).then(console.log); // 微任务1的then（这里需要特别注意传入的onFulFilled不是调用，是函数，是正确的） 构造完微任务以后回到foo的then
}

console.log("end"); // 6.同步函数结尾

```

1.start
2.async 1
3.asyncFunction
4.promise1
5.foo.then
6.end
7.promise2
8.async2
9.setTimeout1
10.setTimeout2